---
title: "CA 4 Part B - Linear Regression Analysis"
subtitle: "Analysis of linear regression performed on randomly sampled data from a pair of columns from a survey of gamer preferences. This includes statement and testing of assumptions followed by intrepretation and dicussion of obtained results."
author: "Gareth Burger"
date: "January, 2023"
output:
  html_notebook:
    toc: yes
toc-title: Table of Contents
---

```{r setup and library load, include=FALSE}
# clear console on each execute and set chunk default to not show code
cat('\014')
#knitr::opts_chunk$set(include = FALSE)

# Load ggplot2
library("ggplot2")
```

---

- Attempting to determine whether any two variables are correlated and if so, what the strength of the relationship between them is
- what is the value of the dependent variable at a certain value of the the independent variable
- clearly identify two chosen variables

From the survey data, I am interested in the relationship between

# Statement of Assumptions
Linear regression testing makes certain assumptions concerning the data it is testing. These four assumptions are described as:\

1. **Independence** - observations are independent of each other
2. **Linearity** - the relationship between the independent and dependent variable is linear (the line of best fit is a straight line)
3. **Homoscedasticity** - the variance of the error doesn't change significantly for each value of the independent variable (the data points don't diverge significantly from the linear line of best fit)
4. **Normality** - the data follows a normal distribution

Furthermore, it can be assumed that the data is randomly sampled and that no hidden relationships exist among observations in the dataset.

---

# Testing of Assumptions
(provide measures, plots and/or justification for your assumptions)
 - tests for normality - shapiro wilk test
 - test for homoscedasticity
 https://www.scribbr.com/statistics/simple-linear-regression/
 
---

# Results
5. Discuss and interpret the analysis conducted and results obtained.
- degree of correlation, r2 value
- should end with a plot of data and a line that fits the data - use ggplot


---

# R Code
â€¢ A 1-3 line description of each R code chunk

```{r Load Data, echo=TRUE}
# R code to load and randomly sample data
# description: to randomly sample the data and to allow some degree of variability across results
# The sample() function in R allows you to take a random sample of elements from a dataset or a vector, either with or without replacement

# load data from the csv
file_name = "./data/amalgamated_game_survey_250_2022.csv"
game_survey_data <- read.csv(file_name)

# sample 200 random elements from the data

# set.seed(some random number) to ensure that we get the same sample each time
set.seed(500)

# sample a random vector of 200 elements from all 250 rows in the game_survey_data dataset
sample_rows <- sample(1:nrow(game_survey_data), 200, replace = FALSE)
sample_rows

# select the 200 rows that match the sampled row numbers
sample <- game_survey_data[sample_rows, ]
sample


# Testing for Normality

# Method 1: Using Histogram / Density Plot
# draw histogram for avg_monthly_expenditure_dlc
hist(sample$avg_monthly_expenditure_dlc, 
     main = "Average Monthly Expenditure on DLC", 
     xlab = "Amount Spent", 
     ylab = "Frequency", 
     breaks = 30, 
     col = 'steelblue')

# Method 2: Using Q-Q Plot
# perform qqnorm test on avg_monthly_expenditure_dc
qqnorm(sample$avg_monthly_expenditure_dlc, 
       pch = 9, 
       frame = FALSE, 
       main = "Average Monthly Expenditure on DLC")
qqline(sample$avg_monthly_expenditure_dlc, 
       col = "darkorchid", 
       lwd = 1)

# Method 3: Statistical Test: Shapiro-Wilk
# perform Shapiro-Wilk test for normality
st <- shapiro.test(sample$avg_monthly_expenditure_dlc)
st
```

Step 3
Look at the data and determine whether it is suitable for linear regression
4 qualities, listed in slides between pages 1-95
https://www.scribbr.com/statistics/simple-linear-regression/

- How well the two data points fit along a line
- Pick two attributes, two columns and determine the degree of correlation between the two variables
- and give some brief discussion and analysis of the correlation
- what is the degree of correlation, are they positively or negatively correlated

```{r}
# R code calculating linear regression for data


```

```{r}
# R code using GGPLOT2 to generate linear regression plot(s)

# Create a scatter plot
# https://ggplot2.tidyverse.org/
# https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf
ggplot(sample, aes(x = gender, y = avg_monthly_expenditure_dlc)) +
  labs(x = "Gender", y = "Amount Spent", title = "Average Monthly Expenditure on DLC") +
  geom_point(aes(color = gender)) +
  theme_light()
  #theme_minimal()
```