---
title: "CA 4: Part B - Linear Regression Analysis"
author: "Gareth Burger"
date: "January, 2023"
output:
  html_document:
    toc: yes
    df_print: paged
  pdf_document:
    toc: yes
  html_notebook:
    toc: yes
subtitle: Analysis of linear regression performed on randomly sampled data from a
  pair of columns from a survey of gamer preferences. This includes statement and
  testing of assumptions followed by intrepretation and dicussion of obtained results.
toc-title: Table of Contents
---

```{r setup and library load, include=FALSE}
# clear console on each execute and set chunk default to not show code
cat('\014')

# Load ggplot2
library("ggplot2")
```

---

# Aim
To perform linear regression on data from a survey of gamer preferences. The variable pair being investigated is 'age' and 'average monthly expenditure DLC'. The aim is to determine whether the two variables are correlated i.e. does a gamer's age affect the amount of money they spend on DLC per month. If so, the independent age variable will have a linear relationship with the dependent variable of money spent.

---

# Statement of Assumptions
Independent variable: Age
Dependent variable: Average Monthly Expenditure DLC

Linear regression makes certain assumptions concerning the data it is testing. These four assumptions are described below:\

1. **Independence** - observations are independent of each other
2. **Linearity** - the relationship between the independent and dependent variable is linear (the line of best fit is a straight line)
3. **Homoscedasticity** - the variance of the error doesn't change significantly for each value of the independent variable (the data points don't diverge significantly from the linear line of best fit)
4. **Normality** - the data of the dependent variable follows a normal distribution

Furthermore, it can be assumed that the data is randomly sampled and that no hidden relationships exist among observations in the dataset.

---

# Testing of Assumptions
### Loading and Randomly Sampling the Data
```{r Load Data, echo=TRUE}
# load data from the csv
file_name = "./data/amalgamated_game_survey_250_2022.csv"
game_survey_data <- read.csv(file_name)

# sample 200 random elements from the data

# set.seed(some random number) to ensure that we get the same sample each time
set.seed(500)

# sample a random vector of 200 elements from all 250 rows in the game_survey_data dataset
sample_rows <- sample(1:nrow(game_survey_data), 200, replace = FALSE)

# select the 200 rows that match the sampled row numbers
sample <- game_survey_data[sample_rows, ]
```

### Testing for Normality

#### Method 1: Using Histogram / Density Plot
```{r Histogram, echo=TRUE}
# draw histogram for avg_monthly_expenditure_dlc
hist(sample$avg_monthly_expenditure_dlc, 
     main = "Average Monthly Expenditure on DLC", 
     xlab = "Amount Spent", 
     ylab = "Frequency", 
     breaks = 30, 
     col = 'steelblue')
```
The histogram of the dependent variable does not exhibit data that is normally distributed as it is not bell-shaped in nature, but rather is more of a multimodal distribution.

#### Method 2: Using Q-Q Plot
```{r QQ Plot, echo=TRUE}
# perform qqnorm test on avg_monthly_expenditure_dc
qqnorm(sample$avg_monthly_expenditure_dlc, 
       pch = 9, 
       frame = FALSE, 
       main = "Average Monthly Expenditure on DLC")
qqline(sample$avg_monthly_expenditure_dlc, 
       col = "darkorchid", 
       lwd = 1)
```

#### Method 3: Shapiro-Wilk Test
```{r Shapiro-Wilk, echo=TRUE}
# perform Shapiro-Wilk test for normality
st <- shapiro.test(sample$avg_monthly_expenditure_dlc)
st
```
 
---

# Results
Look at the data and determine whether it is suitable for linear regression
5. Discuss and interpret the analysis conducted and results obtained.
- degree of correlation, r2 value
- should end with a plot of data and a line that fits the data - use ggplot

---

```{r}
# R code calculating linear regression for data


```

```{r}
# R code using GGPLOT2 to generate linear regression plot(s)

# Create a scatter plot
# https://ggplot2.tidyverse.org/
# https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf
ggplot(sample, aes(x = gender, y = avg_monthly_expenditure_dlc)) +
  labs(x = "Gender", y = "Amount Spent", title = "Average Monthly Expenditure on DLC") +
  geom_point(aes(color = gender)) +
  theme_light()
  #theme_minimal()
```